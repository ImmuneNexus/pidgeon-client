import{s as y,n as g,r as w,o as _}from"../chunks/scheduler.BvLojk_z.js";import{S as x,i as C,e as f,s as k,c as p,f as M,g as v,h as R,d as b,b as D,j as m,l as S}from"../chunks/index.BwOLf_Nb.js";function T(i){let e,t,s="Start",r,o,u="Stop",l,n;return{c(){e=f("div"),t=f("button"),t.textContent=s,r=k(),o=f("button"),o.textContent=u},l(c){e=p(c,"DIV",{});var a=M(e);t=p(a,"BUTTON",{"data-svelte-h":!0}),v(t)!=="svelte-6agj2v"&&(t.textContent=s),r=R(a),o=p(a,"BUTTON",{"data-svelte-h":!0}),v(o)!=="svelte-a1yglz"&&(o.textContent=u),a.forEach(b)},m(c,a){D(c,e,a),m(e,t),m(e,r),m(e,o),l||(n=[S(t,"click",i[0]),S(o,"click",i[1])],l=!0)},p:g,i:g,o:g,d(c){c&&b(e),l=!1,w(n)}}}function W(i){let e=null,t=null,s=null,r=null,o=!1;return _(async()=>{try{await navigator.mediaDevices.getUserMedia({audio:!0}),e=new(window.AudioContext||window.webkitAudioContext),r=new WebSocket("ws://localhost:8765"),r.binaryType="arraybuffer",r.onopen=()=>{console.log("WebSocket connection opened")},r.onerror=n=>{console.error("WebSocket error:",n)},r.onclose=()=>{console.log("WebSocket connection closed")}}catch(n){console.error("Error initializing WebSocket or getting microphone access:",n)}}),[async()=>{if(!o){o=!0;try{e.resume();const n=await navigator.mediaDevices.getUserMedia({audio:!0});t=e.createMediaStreamSource(n),s=e.createScriptProcessor(4096,1,1),t.connect(s),s.connect(e.destination),s.onaudioprocess=c=>{const a=c.inputBuffer.getChannelData(0),h=new Int16Array(a.length);for(let d=0;d<a.length;d++)h[d]=Math.max(-1,Math.min(1,a[d]))*32767;r.send(h.buffer)},console.log("Recording started")}catch(n){console.error("Error starting recording:",n)}}},async()=>{if(o){o=!1;try{s&&s.disconnect(),t&&t.disconnect(),e&&e.close(),console.log("Recording stopped")}catch(n){console.error("Error stopping recording:",n)}}}]}class U extends x{constructor(e){super(),C(this,e,W,T,y,{})}}export{U as component};
